<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#ffffff" id="theme-color-meta">
  <title>Material Definition System v3.0 — Interactive Demonstration</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Times New Roman', 'Georgia', serif;
      font-size: 16px;
      line-height: 1.6;
      color: #000;
      background: #fff;
      padding: 40px 20px;
      max-width: 900px;
      margin: 0 auto;
    }

    body[data-theme="dark"] {
      background: #000;
      color: #fff;
    }

    h1 {
      font-size: 28px;
      font-weight: bold;
      margin-bottom: 8px;
      text-align: center;
      letter-spacing: -0.02em;
    }

    h2 {
      font-size: 20px;
      font-weight: bold;
      margin-top: 40px;
      margin-bottom: 16px;
      border-bottom: 1px solid currentColor;
      padding-bottom: 4px;
    }

    p {
      margin-bottom: 12px;
    }

    ul, ol {
      margin: 0 0 16px 24px;
    }

    li {
      margin-bottom: 6px;
    }

    .subtitle {
      text-align: center;
      font-style: italic;
      margin-bottom: 32px;
      font-size: 14px;
    }

    .version-badge {
      display: inline-block;
      padding: 4px 12px;
      background: #000;
      color: #fff;
      font-size: 12px;
      font-weight: bold;
      border-radius: 4px;
      margin-left: 8px;
    }

    body[data-theme="dark"] .version-badge {
      background: #fff;
      color: #000;
    }

    .overview-box {
      margin: 32px 0;
      padding: 20px 24px;
      border: 1px solid currentColor;
    }

    .overview-box strong {
      display: block;
      margin-bottom: 12px;
    }

    code {
      font-family: 'Courier New', monospace;
      font-size: 14px;
      background: rgba(0, 0, 0, 0.05);
      padding: 2px 6px;
      border-radius: 3px;
    }

    body[data-theme="dark"] code {
      background: rgba(255, 255, 255, 0.1);
    }

    pre {
      font-family: 'Courier New', monospace;
      font-size: 13px;
      background: rgba(0, 0, 0, 0.03);
      padding: 16px;
      border: 1px solid currentColor;
      overflow-x: auto;
      margin: 16px 0;
      line-height: 1.4;
    }

    body[data-theme="dark"] pre {
      background: rgba(255, 255, 255, 0.05);
    }

    .materials-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 24px;
      margin: 32px 0;
      padding: 24px 0;
      border-top: 1px solid currentColor;
      border-bottom: 1px solid currentColor;
    }

    .material-card {
      text-align: center;
    }

    .material-sample {
      width: 200px;
      height: 200px;
      margin: 0 auto 12px;
      border: 1px solid currentColor;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
      font-weight: bold;
      cursor: pointer;
      user-select: none;
    }

    .material-name {
      font-weight: bold;
      margin-bottom: 4px;
      font-size: 14px;
    }

    .material-desc {
      font-size: 12px;
      font-style: italic;
      color: #666;
    }

    body[data-theme="dark"] .material-desc {
      color: #999;
    }

    .controls {
      margin: 32px 0;
      padding: 16px;
      border: 1px solid currentColor;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 16px;
    }

    .control-group {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .control-label {
      font-size: 14px;
      font-weight: bold;
    }

    button {
      font-family: 'Times New Roman', 'Georgia', serif;
      font-size: 14px;
      padding: 6px 16px;
      background: transparent;
      border: 1px solid currentColor;
      color: currentColor;
      cursor: pointer;
      transition: all 0.2s;
    }

    button:hover {
      background: #000;
      color: #fff;
    }

    body[data-theme="dark"] button:hover {
      background: #fff;
      color: #000;
    }

    button.active {
      background: #000;
      color: #fff;
    }

    body[data-theme="dark"] button.active {
      background: #fff;
      color: #000;
    }

    .blur-demo-bg {
      position: fixed;
      inset: 0;
      z-index: -1;
      opacity: 0;
      transition: opacity 0.3s;
      background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(0,0,0,0.03) 10px, rgba(0,0,0,0.03) 20px);
    }

    body[data-theme="dark"] .blur-demo-bg {
      background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,0.03) 10px, rgba(255,255,255,0.03) 20px);
    }

    .blur-demo-bg.active {
      opacity: 1;
    }

    footer {
      margin-top: 64px;
      padding-top: 16px;
      border-top: 1px solid currentColor;
      font-size: 12px;
      text-align: center;
      color: #666;
    }

    body[data-theme="dark"] footer {
      color: #999;
    }
  </style>
</head>
<body data-theme="light">
  <div class="blur-demo-bg" id="blur-bg"></div>

  <!-- Header -->
  <h1>
    Material Definition System
    <span class="version-badge">v3.0</span>
  </h1>
  <p class="subtitle">Manifest-driven material properties with tactile physics</p>

  <!-- Overview -->
  <div class="overview-box">
    <strong>Overview</strong>
    <p>
      MDS applies material properties (optics, surface, behavior) to DOM elements via JSON manifests.
      Define materials once, apply everywhere with <code>data-material="name"</code>.
    </p>
    <ul style="margin: 12px 0 0 24px;">
      <li><strong>Manifest-driven</strong>: Materials defined in JSON, loaded at runtime</li>
      <li><strong>Theme-aware</strong>: Auto light/dark switching</li>
      <li><strong>State management</strong>: hover, press, pressed-and-moving, focus, disabled</li>
      <li><strong>Physics system</strong>: Tactile deformation response (new in v3.0)</li>
      <li><strong>Zero dependencies</strong>: Standalone runtime</li>
    </ul>
  </div>

  <!-- What's New -->
  <h2>What's New in v3.0</h2>
  <ul>
    <li><strong>Physics system</strong>: External physics files for tactile simulation (<code>.physics.js</code>)</li>
    <li><strong>Liquid silicone material</strong>: Elastic deformation with configurable spring parameters (K, D)</li>
    <li><strong>Clean architecture</strong>: Material = Visual + Tactile | External behavior engines handle positional interactions</li>
    <li><strong>Interop API</strong>: Query/drive material state from external systems (UICP integration)</li>
    <li><strong>Auto-migration</strong>: Deprecated fields (elasticity, viscosity) → physicsParams with console warnings</li>
  </ul>

  <!-- Materials -->
  <h2>Built-in Materials</h2>
  <p>
    Three materials demonstrate the system architecture. Visual effects are minimal (CSS limitations), but physics
    simulation showcases tactile response. Drag the liquid silicone sample to see elastic deformation.
  </p>

  <div class="materials-grid">
    <!-- Glass -->
    <div class="material-card">
      <div class="material-sample" data-material="@mds/glass">A</div>
      <div class="material-name">Glass</div>
      <div class="material-desc">Backdrop blur + shadows</div>
    </div>

    <!-- Paper -->
    <div class="material-card">
      <div class="material-sample" data-material="@mds/paper">B</div>
      <div class="material-name">Paper</div>
      <div class="material-desc">SVG noise texture</div>
    </div>

    <!-- Liquid Silicone (NEW) -->
    <div class="material-card">
      <div class="material-sample" data-material="@mds/liquid-silicone" id="silicone-sample">C</div>
      <div class="material-name">Liquid Silicone (NEW)</div>
      <div class="material-desc">Elastic physics (K=22, D=18)</div>
    </div>
  </div>

  <!-- Controls -->
  <div class="controls">
    <div class="control-group">
      <span class="control-label">Theme:</span>
      <button id="btn-light" class="active">Light</button>
      <button id="btn-dark">Dark</button>
    </div>
    <div class="control-group">
      <button id="btn-blur-toggle">Show Background Pattern</button>
    </div>
  </div>

  <!-- Quick Start -->
  <h2>Quick Start</h2>
  <pre>// 1. Install
npm install @v1b3x0r/mds-core

// 2. HTML
&lt;div data-material="@mds/glass"&gt;Content&lt;/div&gt;

// 3. Load materials
const manifest = await fetch('./glass.mdm.json').then(r => r.json())
MaterialSystem.register('@mds/glass', manifest)
MaterialSystem.apply()</pre>

  <!-- Architecture -->
  <h2>Architecture</h2>
  <p>
    <strong>Material Layer (MDS)</strong>: Visual (optics, surface) + Tactile (deformation physics)<br>
    <strong>Behavior Layer (External)</strong>: Positional interactions (drag-to-move, scroll, etc.)<br>
    <strong>Interop API</strong>: Query material state, drive visual transitions
  </p>
  <pre>// Material = Visual + Tactile (deform only, no translate)
{
  "name": "@mds/liquid-silicone",
  "optics": { "tint": "rgba(200, 200, 255, 0.3)" },
  "surface": { "radius": "16px" },
  "behavior": {
    "physics": "./liquid-silicone.physics.js",
    "physicsParams": { "K": 22, "D": 18, "mass": 1.5 }
  }
}</pre>

  <!-- System Details -->
  <h2>System Details</h2>
  <ul>
    <li><strong>Runtime size</strong>: 6.74 KB (ESM gzipped)</li>
    <li><strong>Browser support</strong>: Chrome 90+, Firefox 88+, Safari 14+</li>
    <li><strong>Dependencies</strong>: Zero</li>
    <li><strong>License</strong>: MIT</li>
    <li><strong>GitHub</strong>: <a href="https://github.com/v1b3x0r/material-js-concept" style="color: currentColor;">v1b3x0r/material-js-concept</a></li>
    <li><strong>npm</strong>: <a href="https://www.npmjs.com/package/@v1b3x0r/mds-core" style="color: currentColor;">@v1b3x0r/mds-core</a></li>
  </ul>

  <!-- Footer -->
  <footer>
    Material Definition System v3.0 — Interactive Demonstration<br>
    2025 © MIT License | <a href="https://github.com/v1b3x0r/material-js-concept" style="color: inherit;">GitHub</a>
  </footer>

  <!-- Load MDS - Auto-detect dev (Vite) vs production (CDN) -->
  <script type="module">
    // Check if Vite dev server is available
    const isDev = import.meta.env?.DEV ?? false

    let MDS

    if (isDev) {
      // Development: Load from source
      MDS = (await import('./src/index.ts')).default
    } else {
      // Production: Load from CDN
      const script = document.createElement('script')
      script.src = 'https://unpkg.com/@v1b3x0r/mds-core@3.0.0/dist/mds.umd.js'
      document.head.appendChild(script)

      await new Promise((resolve, reject) => {
        script.onload = resolve
        script.onerror = reject
      })

      MDS = window.MaterialSystem
    }

    // Load materials from CDN manifests
    const cdnBase = 'https://unpkg.com/@v1b3x0r/mds-core@3.0.0'

    async function loadMaterials() {
      const [glass, paper, liquidSilicone] = await Promise.all([
        fetch(`${cdnBase}/manifests/@mds/glass.mdm.json`).then(r => r.json()),
        fetch(`${cdnBase}/manifests/@mds/paper.mdm.json`).then(r => r.json()),
        fetch(`${cdnBase}/manifests/@mds/liquid-silicone.mdm.json`).then(r => r.json())
      ])

      MDS.register('@mds/glass', glass)
      MDS.register('@mds/paper', paper)
      MDS.register('@mds/liquid-silicone', liquidSilicone)
      MDS.apply()
    }

    loadMaterials().then(() => {
      console.log('✅ Materials loaded')
    }).catch(err => {
      console.error('❌ Failed to load materials:', err)
    })

    // Expose for theme switcher
    window.MaterialSystem = MDS

    // Theme switching
    const btnLight = document.getElementById('btn-light')
    const btnDark = document.getElementById('btn-dark')
    const themeColorMeta = document.getElementById('theme-color-meta')

    function setTheme(theme) {
      document.body.setAttribute('data-theme', theme)
      MaterialSystem.setTheme(theme)

      if (theme === 'light') {
        btnLight.classList.add('active')
        btnDark.classList.remove('active')
        themeColorMeta.setAttribute('content', '#ffffff')
      } else {
        btnDark.classList.add('active')
        btnLight.classList.remove('active')
        themeColorMeta.setAttribute('content', '#000000')
      }
    }

    btnLight.addEventListener('click', () => setTheme('light'))
    btnDark.addEventListener('click', () => setTheme('dark'))

    // Blur pattern toggle
    const btnBlurToggle = document.getElementById('btn-blur-toggle')
    const blurBg = document.getElementById('blur-bg')
    let blurActive = false

    btnBlurToggle.addEventListener('click', () => {
      blurActive = !blurActive
      blurBg.classList.toggle('active', blurActive)
      btnBlurToggle.textContent = blurActive ? 'Hide Background Pattern' : 'Show Background Pattern'
    })
  </script>
</body>
</html>
